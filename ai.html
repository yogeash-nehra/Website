<section class="wh-ai-ready">
  <style>
    /* Layout sanity for constrained editors (GHL code editor) */
    *, *:before, *:after { box-sizing: border-box; }

    :root { --wh-gold:#d8aa6a; --wh-black:#111111; --wh-white:#ffffff; --wh-gray:#f6f6f7; }

    /* Constrained max width so cards don't overflow small editor panes */
    .wh-wrap { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif; color: var(--wh-black); width:100%; }
    /* allow full-width inside GHL editor while keeping internal padding to avoid overlap */
    .wh-max { width:100%; max-width: none; margin: 0; padding: 20px; box-sizing: border-box; }

    /* Cards and grids: add vertical spacing between cards to avoid overlap */
    .wh-grid { display:grid; gap:20px; grid-template-columns: repeat(12,1fr); width:100%; }
    /* slightly larger padding & margin to prevent overlap in the GHL editor */
    .wh-card { width: 100%; background:var(--wh-white); border:1px solid #ececec; border-radius:12px; padding:18px; margin-bottom:18px; box-shadow:none; }
    .wh-card h2 { font-size: clamp(18px,2.2vw,22px); margin:0 0 12px; }
    .muted { opacity:.78; }
    .small { font-size:13px; line-height:1.35; }
    .chip { display:inline-block; font-size:12px; background:#faefe1; color:#7a5a2b; padding:4px 8px; border-radius:999px; margin-right:6px; }

    /* Checklist */
    .wh-check { display:grid; gap:16px; grid-template-columns: repeat(12,1fr); margin-top:10px; }
    .wh-block { grid-column: span 6; border:1px solid #e9e9e9; border-radius:10px; padding:14px; background:#fff; margin:0; min-width:0; }
    .wh-block + .wh-block { margin-top:8px; }
    .wh-block h3 { margin:0 0 8px; font-size:15px; }
    .wh-q { display:grid; gap:10px; }
    .wh-row { display:flex; justify-content:space-between; align-items:center; gap:10px; background:#fafafa; border:1px solid #f0f0f0; border-radius:8px; padding:8px 10px; }
    .wh-row label { flex: 1 1 auto; font-size:14px; margin-right:10px; }
    .wh-row select { min-width:120px; max-width:220px; border:1px solid #e0e0e0; padding:8px 10px; border-radius:8px; font-size:13px; background:#fff; }

    .wh-summary { display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top:10px; }
    .wh-score { font-weight:600; }
    .wh-badge { padding:6px 10px; border-radius:999px; font-size:13px; color:#fff; }
    .ok { background:#159957; }
    .mid { background:#d8aa6a; }
    .low { background:#b00020; }

    /* Columns */
    .wh-cols { display:grid; gap:12px; grid-template-columns: repeat(12,1fr); margin-top:10px; }
    .wh-col { grid-column: span 6; border:1px solid #ececec; border-radius:10px; padding:12px; background:#fff; }
    .wh-col h4 { margin:0 0 6px; font-size:15px; }
    .wh-col ul { margin: 6px 0 0 18px; padding:0; }
    .wh-col li { margin: 4px 0; }

    /* ROI calc */
    .wh-form { display:grid; gap:10px; grid-template-columns: repeat(12,1fr); margin-top:8px; }
    .wh-field { grid-column: span 4; display:flex; flex-direction:column; gap:6px; }
    .wh-field input { padding:10px 12px; border:1px solid #ddd; border-radius:8px; font-size:14px; }
    .wh-result { grid-column: span 12; background:#f7f7f7; border:1px solid #eee; border-radius:10px; padding:12px; }

    /* Accordions */
    details { border:1px solid #ececec; border-radius:10px; padding:10px 12px; background:#fff; margin-bottom:8px; }
    summary { cursor:pointer; font-weight:600; outline:none; }

    /* Buttons */
    .wh-cta { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .wh-btn { display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid var(--wh-black); text-decoration:none; color:var(--wh-black); background:var(--wh-white); font-size:14px; }
    .wh-btn.primary { background:var(--wh-gold); border-color:var(--wh-gold); color:var(--wh-white); }
    .wh-btn.ghost { background:transparent; border-color:#ddd; }

    /* Lock and blur: don't use fixed/absolute — keep flow in editor */
    .wh-locked { position: relative; filter: blur(3px); pointer-events: none; }
    .wh-locked select { pointer-events: none; }
    .wh-lockbar { margin-top: 10px; border:1px solid #ececec; border-radius:10px; background:#fff; padding:8px; }
    .wh-lockbar-inner { padding:8px; display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; }
    .wh-lock-text { font-size:14px; max-width:56%; }

    /* CTA card tweaks */
    .wh-cta-card p { margin: 6px 0 10px; }
    .wh-cta-card .wh-cta { margin-top:6px; }

    /* Small screens / constrained editor panes */
    @media (max-width: 900px){
      .wh-block, .wh-col, .wh-field { grid-column: span 12; }
      .wh-lockbar-inner { flex-direction:column; align-items:flex-start; gap:8px; }
      .wh-lock-text { max-width:100%; }
      .wh-row { flex-direction: column; align-items: stretch; }
      .wh-row select { width:100%; max-width:100%; }
      .wh-cta { justify-content:flex-start; }
    }

    /* Extra guard: ensure everything wraps in very narrow editors */
    @media (max-width: 520px){
      .wh-max { padding: 12px; }
      .wh-card { padding:12px; }
      .wh-btn { padding:10px 12px; font-size:13px; }
    }
  </style>

  <div class="wh-wrap">
    <div class="wh-max">

      <!-- CHECKLIST -->
      <div id="checklist" class="wh-card">
        <h2>AI Adoption Pathway checklist</h2>
        <p class="muted small">Answer the visible questions now. More advanced items unlock after registration. Yes = 2 points, Partly = 1, No = 0.</p>

        <!-- lock overlay (moved to top of checklist) -->
        <div class="wh-lockbar" id="wh-lockbar">
          <div class="wh-lockbar-inner">
            <div class="wh-lock-text">
              Some advanced questions are locked. Register to unlock and get a tailored plan.
            </div>
            <div class="wh-cta">
              <a class="wh-btn primary" id="wh-register" href="https://YOUR-GHL-FORM-URL" target="_blank" rel="noopener">Register to unlock</a>
              <button class="wh-btn" id="wh-i-registered">I have registered</button>
            </div>
            <p class="small muted" style="margin:6px 0 0;">After registering you will be auto-unlocked, or use the button above.</p>
          </div>
        </div>

        <div class="wh-check" id="wh-check">
          <!-- Strategy -->
          <div class="wh-block">
            <h3><span class="chip">Strategy</span> Direction and priorities</h3>
            <div class="wh-q" data-cat="Strategy">
              <!-- visible -->
              <div class="wh-row">
                <label>We have a written AI vision linked to business outcomes</label>
                <select><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
              <!-- locked -->
              <div class="wh-row wh-locked" data-locked="1">
                <label>Our AI roadmap is tied to quarterly targets and owners</label>
                <select disabled><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
            </div>
          </div>

          <!-- People -->
          <div class="wh-block">
            <h3><span class="chip">People</span> Skills and change readiness</h3>
            <div class="wh-q" data-cat="People">
              <!-- visible -->
              <div class="wh-row">
                <label>Staff have baseline AI literacy training</label>
                <select><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
              <!-- locked -->
              <div class="wh-row wh-locked" data-locked="1">
                <label>We have an enablement guild and adoption scorecards</label>
                <select disabled><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
            </div>
          </div>

          <!-- Data -->
          <div class="wh-block">
            <h3><span class="chip">Data</span> Access and quality</h3>
            <div class="wh-q" data-cat="Data">
              <!-- visible -->
              <div class="wh-row">
                <label>Key data is accessible and organised</label>
                <select><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
              <!-- locked -->
              <div class="wh-row wh-locked" data-locked="1">
                <label>We have privacy, retention, and Māori data sovereignty policies</label>
                <select disabled><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
            </div>
          </div>

          <!-- Process -->
          <div class="wh-block">
            <h3><span class="chip">Process</span> Ways of working</h3>
            <div class="wh-q" data-cat="Process">
              <!-- visible -->
              <div class="wh-row">
                <label>We map workflows and bottlenecks regularly</label>
                <select><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
              <!-- locked -->
              <div class="wh-row wh-locked" data-locked="1">
                <label>We run pilots, measure ROI, and templatise wins</label>
                <select disabled><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
            </div>
          </div>

          <!-- Technology -->
          <div class="wh-block">
            <h3><span class="chip">Technology</span> Tools and security</h3>
            <div class="wh-q" data-cat="Technology">
              <!-- visible -->
              <div class="wh-row">
                <label>We have approved AI tools and vendor standards</label>
                <select><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
              <!-- locked -->
              <div class="wh-row wh-locked" data-locked="1">
                <label>We connect systems via APIs or iPaaS with role based access</label>
                <select disabled><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
            </div>
          </div>

          <!-- Risk and Ethics -->
          <div class="wh-block">
            <h3><span class="chip">Risk and Ethics</span> Safe and responsible use</h3>
            <div class="wh-q" data-cat="Risk">
              <!-- visible -->
              <div class="wh-row">
                <label>We have guidelines for acceptable AI use</label>
                <select><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
              <!-- locked -->
              <div class="wh-row wh-locked" data-locked="1">
                <label>We assess bias and quality, with an escalation process</label>
                <select disabled><option>No</option><option>Partly</option><option>Yes</option></select>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- CTA: Book a consult -->
      <div class="wh-card wh-cta-card">
        <h2>Book a consult</h2>
        <p class="small muted">Get a tailored roadmap for your organisation. We map quick wins, pick the first automation, and set success metrics.</p>
        <div class="wh-cta" style="margin-top:6px;">
          <a class="wh-btn primary" href="https://YOUR-GHL-FORM-URL" target="_blank" rel="noopener">Book a consult</a>
          <a class="wh-btn ghost" href="/workshops">Explore workshops</a>
        </div>
      </div>

      <!-- FAQ -->
      <div class="wh-card">
        <h2>FAQ</h2>
        <details>
          <summary>Is our data safe</summary>
          <p class="small">We use approved tools, role based access, and clear privacy settings. We also align to Māori data sovereignty where relevant.</p>
        </details>
        <details style="margin-top:8px;">
          <summary>What is the first step if we score low</summary>
          <p class="small">Start with a 60 minute roadmap session and one simple automation that saves time every week. Build confidence and scale from there.</p>
        </details>
      </div>

    </div>
  </div>

  <script>
    // ========== Readiness scoring ==========
    function scoreSelect(val){
      if(val === "Yes") return 2;
      if(val === "Partly") return 1;
      return 0;
    }
    function calcScore(){
      const selects = document.querySelectorAll('.wh-q select');
      let s = 0; selects.forEach(sel => s += scoreSelect(sel.value));
      // score/tier UI removed per request — keep calculation if needed elsewhere
      // Plan output elements removed; guarded checks prevent errors.
      const planIntro = document.getElementById('plan-intro');
      const planList = document.getElementById('plan-list');
      if(!planIntro || !planList) return;
    }
    document.addEventListener('change', (e)=>{
      if(e.target && e.target.matches('.wh-q select')) calcScore();
    });
    window.addEventListener('DOMContentLoaded', calcScore);

    // ========== ROI calculator ==========
    function calcROI(){
      const people = parseFloat(document.getElementById('roi-people')?.value || "0");
      const min = parseFloat(document.getElementById('roi-min')?.value || "0");
      const runs = parseFloat(document.getElementById('roi-runs')?.value || "0");
      const hours = Math.round((people * min * runs) / 60);
      const out = document.getElementById('roi-out');
      if(out) out.textContent = "Estimated weekly saving: " + hours + " hours";
    }
    ['roi-people','roi-min','roi-runs'].forEach(id=>{
      const el = document.getElementById(id);
      if(el) el.addEventListener('input', calcROI);
    });
    window.addEventListener('DOMContentLoaded', calcROI);

    // ========== Lock / unlock helpers ==========
    function getParam(name){
      const u = new URL(window.location.href);
      return u.searchParams.get(name);
    }
    function isUnlocked(){
      return localStorage.getItem('wh_ai_unlocked') === '1' || getParam('unlock') === '1' || getParam('ghl') === '1';
    }
    function setUnlocked(){
      localStorage.setItem('wh_ai_unlocked','1');
    }
    function applyLockState(){
      const lockedRows = document.querySelectorAll('.wh-locked');
      const bar = document.getElementById('wh-lockbar');
      const unlocked = isUnlocked();
      lockedRows.forEach(row=>{
        const sel = row.querySelector('select');
        if(unlocked){
          row.classList.remove('wh-locked');
          if(sel) sel.disabled = false;
        } else {
          row.classList.add('wh-locked');
          if(sel) sel.disabled = true;
        }
      });
      if(bar) bar.style.display = unlocked ? 'none' : 'block';
    }
    window.addEventListener('DOMContentLoaded', applyLockState);
    document.addEventListener('click', (e)=>{
      if(e.target && e.target.id === 'wh-i-registered'){
        setUnlocked();
        applyLockState();
      }
    });
  </script>
</section>
